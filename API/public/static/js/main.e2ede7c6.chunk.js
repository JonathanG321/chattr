(this.webpackJsonpchattr=this.webpackJsonpchattr||[]).push([[0],{100:function(e,t){},104:function(e,t,a){},105:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){},108:function(e,t,a){},109:function(e,t,a){},110:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(30),s=a.n(c),o=a(21),i=a(9),u=a(10),l=a(15),m=a(11),p=a(12),f=a(4);var d=function(){return r.a.createElement("main",null,r.a.createElement("h1",null,"404 Not Found"))},v=a(1),h=a.n(v),E=a(5),g="".concat("").concat("/api/v1"),b=new Headers({Accept:"application/json, text/plain, */*","Content-type":"application/json"}),y=a(63),O=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e,n){var r;return Object(u.a)(this,a),(r=t.call(this,n)).serverErrors=e,r}return a}(Object(y.a)(Error)),N=function(e){return fetch("".concat(g,"/session"),{method:"POST",headers:b,credentials:"include",body:JSON.stringify(e)}).then(function(){var e=Object(E.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200===t.status){e.next=6;break}return e.t0=O,e.next=4,t.json();case 4:throw e.t1=e.sent,new e.t0(e.t1);case 6:return e.abrupt("return",t.json());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},j=function(){return fetch("".concat(g,"/session"),{method:"DELETE",credentials:"include"}).then((function(e){return e.json()}))},w=function(){return fetch("".concat(g,"/users/current"),{credentials:"include"}).then(function(){var e=Object(E.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200===t.status){e.next=6;break}return e.t0=O,e.next=4,t.json();case 4:throw e.t1=e.sent,new e.t0(e.t1);case 6:return e.abrupt("return",t.json());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},k=function(e){return fetch("".concat(g,"/users"),{method:"POST",headers:b,credentials:"include",body:JSON.stringify(e)}).then(function(){var e=Object(E.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200===t.status){e.next=6;break}return e.t0=O,e.next=4,t.json();case 4:throw e.t1=e.sent,new e.t0(e.t1);case 6:return e.abrupt("return",t.json());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},x=a(59),S=a.n(x),I=function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"CHANGE_ROOM",payload:e}),a(_(e));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},R=function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"ADD_NOTIFICATION",payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},_=function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"REMOVE_NOTIFICATION",payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},C=function(e){return function(t){var a=S()("",{query:{username:e}});t(U(a)),t({type:"CREATE_SOCKET",payload:a})}},U=function(e){return function(t){e.on("connect",(function(){})),e.on("join room",(function(a){var n,r=a.replace(e.query.username,"");t((n={roomName:a,displayRoomName:r,messages:[]},function(){var e=Object(E.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"ADD_ROOM",payload:n});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))})),e.on("leave room",(function(e){var a;t((a=e,function(){var e=Object(E.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"REMOVE_ROOM",payload:a});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))})),e.on("set room",(function(e){t(I(e))})),e.on("message",(function(e){var a;t((a=e,function(){var e=Object(E.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"ADD_MESSAGE",payload:a}),t(R(a.roomName));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}))}},D=function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N(e);case 3:n=t.sent,a(M(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a(G(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},T=function(e){return function(t){return j().then((function(){return t(A(e))}))}},A=function(e){return function(t){t({type:"SIGN_OUT"}),e.push("/")}},L=function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k(e);case 3:n=t.sent,a(M(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a(G(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},F=function(){return function(){var e=Object(E.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w();case 3:a=e.sent,t(M(a)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t(G(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},M=function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"SIGN_IN",payload:e}),a(C(e.username));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},G=function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"SIGN_IN_FAILURE",payload:e.serverErrors.errors});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};var P=function(e){var t={createSession:D,destroySession:T,createUser:L,getCurrentUser:F};return Object(f.g)(Object(o.b)((function(e){return{user:e.session.user,errors:e.session.errors,isLoading:e.session.isLoading,socket:e.socket.socket}}),t)((function(t){return r.a.createElement(e,Object.assign({},t,{getCurrentUser:function(){return t.getCurrentUser()},onSignIn:function(e){return t.createSession(e)},onSignUp:function(e){return t.createUser(e)},onSignOut:function(){return t.socket.close(),t.destroySession(t.history)}}))})))},V=a(3),J=(a(14),a(57),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){null===e.user&&this.props.user&&this.props.user.id&&this.props.history.push("/chat")}},{key:"render",value:function(){var e=this.props,t=e.onSignIn,a=e.errors;return r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"Sign In"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=new FormData(e.currentTarget),n={email:a.get("email"),password:a.get("password")};t(n)}},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{className:"form-item",type:"email",name:"email"})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{className:"form-item",type:"password",name:"password"})),!!a&&a.map((function(e){return"RecordNotFoundError"===e.type?r.a.createElement("p",{className:"error",key:e.message},e.message):null})),r.a.createElement("input",{className:"button",type:"submit",value:"Login"})))}}]),a}(n.Component)),X=Object(f.g)(P(J));var H=function(e){var t=e.errors,a=e.type;return t?t.map((function(e){return e.path===a?r.a.createElement("p",{className:"error",key:e.message},e.message):null})):null},q=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){null===e.user&&this.props.user&&this.props.user.id&&this.props.history.push("/chat")}},{key:"render",value:function(){var e=this.props,t=e.onSignUp,a=e.errors;return r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"Sign Up"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=new FormData(e.currentTarget),n={username:a.get("username"),email:a.get("email"),avatar:a.get("avatar"),password:a.get("password"),passwordConfirmation:a.get("password-confirmation")};t(n)}},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"username"},r.a.createElement("strong",null,"Username")),r.a.createElement("input",{className:"form-item",type:"text",name:"username"}),r.a.createElement(H,{errors:a,type:"username"})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"email"},r.a.createElement("strong",null,"Email")),r.a.createElement("input",{className:"form-item",type:"email",name:"email"}),r.a.createElement(H,{errors:a,type:"email"})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"avatar"},r.a.createElement("strong",null,"User Avatar")),r.a.createElement("input",{className:"form-item",type:"url",name:"avatar",placeholder:"https://i.kym-cdn.com/entries/icons/original/000/013/564/doge.jpg"}),r.a.createElement(H,{errors:a,type:"avatar"})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},r.a.createElement("strong",null,"Password")),r.a.createElement("input",{className:"form-item",type:"password",name:"password"}),r.a.createElement(H,{errors:a,type:"password"})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password-confirmation"},r.a.createElement("strong",null,"Password Confirmation")),r.a.createElement("input",{className:"form-item",type:"password",name:"password-confirmation"}),r.a.createElement(H,{errors:a,type:"passwordConfirmation"})),r.a.createElement("input",{className:"button",type:"submit",value:"Sign Up"})))}}]),a}(n.Component),z=Object(f.g)(P(q)),B=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.user&&this.props.history.push("/chat")}},{key:"render",value:function(){return r.a.createElement("div",{className:"home-page"},r.a.createElement("div",{className:"auth-card justify-center-vertical align-items-center-vertical"},r.a.createElement("h1",{className:"title"},"Chattr"),r.a.createElement(i.b,{className:"max-width",to:"sign-in"},r.a.createElement("button",{className:"button max-width"},"Sign in with Existing Account")),r.a.createElement(i.b,{className:"max-width",to:"/sign-up"},r.a.createElement("button",{className:"button mt-1 max-width"},"Sign Up with New Account"))))}}]),a}(n.Component),K=Object(f.g)(P(B)),W=a(22);var $=function(e){var t=e.user;return r.a.createElement("img",{className:"user-avatar",src:"".concat(t.avatar),alt:t.username})};var Q=function(e){var t=e.onSubmit,a=e.roomName;return r.a.createElement("div",{className:"max-height"},r.a.createElement("form",{className:"flex max-height",onSubmit:function(e){e.preventDefault();var n={message:new FormData(e.currentTarget).get("message"),roomName:a,date:new Date};e.currentTarget.reset(),n.message&&t(n)}},r.a.createElement("div",{className:"message-text flex justify-center align-items-center"},r.a.createElement("textarea",{className:"form-item text",name:"message"})),r.a.createElement("div",{className:"message-submit flex justify-center align-items-center"},r.a.createElement("input",{type:"submit",className:"button",value:"Send Message"}))))},Y=a(17),Z=a.n(Y);a(104);var ee=function(e){var t=e.isCurrentUser,a=e.message;return r.a.createElement("div",{className:Z()("max-height","flex","user-message",{"current-user-message":t})},r.a.createElement("div",null,r.a.createElement("div",{className:"limit-username"},r.a.createElement("strong",null,a.user.username)),r.a.createElement("div",{className:Z()("message-content",{"current-user-message-content":t})},a.message)),r.a.createElement("div",{className:"margin-15"},r.a.createElement($,{user:a.user})))};a(105);var te=function(e){var t=e.user,a=e.messages;return r.a.createElement("div",{className:"messages-display max-height flex"},a.map((function(e){return e.isAlert?r.a.createElement("div",{key:"".concat(e.message," ").concat(e.user.username," ").concat(e.date),className:"message-container flex justify-center align-items-center"},r.a.createElement("div",{className:"alert-message"},e.message)):r.a.createElement("div",{key:"".concat(e.message," ").concat(e.user.username," ").concat(e.date),className:"message-container"},r.a.createElement(ee,{message:e,isCurrentUser:t.username===e.user.username}))})))};var ae=function(e){var t={changeRoom:I};return Object(o.b)((function(e){return{rooms:e.rooms.rooms,currentRoom:e.rooms.currentRoom,socket:e.socket.socket,notifications:e.rooms.notifications}}),t)((function(t){return r.a.createElement(e,Object.assign({},t,{changeRoom:function(e){return t.changeRoom(e)},sendMessage:function(e){t.socket.emit("message",e)}}))}))},ne=a(60),re=a.n(ne);a(106);var ce=function(e){var t=e.room,a=e.changeRoom,n=e.displayNotification,c=void 0!==n&&n,s=e.isCurrentRoom;return r.a.createElement("button",{className:Z()("button","max-width","flex","align-items-center","justify-center",{"current-room":s}),onClick:function(){return a(t.roomName)}},r.a.createElement("span",{className:"width-80"},t.displayRoomName?t.displayRoomName:t.roomName),c&&r.a.createElement("span",{className:"red-text flex align-items-center no-width"},r.a.createElement("img",{className:"notification-icon",src:re.a,alt:"Notification Icon"})))},se=(a(107),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={displayLogout:!1},n.clickUserIcon=n.clickUserIcon.bind(Object(W.a)(n)),n.clickNotUserIcon=n.clickNotUserIcon.bind(Object(W.a)(n)),n.logout=n.logout.bind(Object(W.a)(n)),n}return Object(l.a)(a,[{key:"clickUserIcon",value:function(){!1===this.state.displayLogout?this.setState({displayLogout:!0}):this.setState({displayLogout:!1})}},{key:"clickNotUserIcon",value:function(e){"user-avatar"!==e.target.className&&this.setState({displayLogout:!1})}},{key:"logout",value:function(){(0,this.props.onSignOut)()}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.sendMessage,n=e.currentRoom,c=e.changeRoom,s=e.rooms,o=e.notifications,i=this.state.displayLogout,u=s.find((function(e){return e.roomName===n}));return r.a.createElement("main",{onClick:this.clickNotUserIcon,className:"max-height"},r.a.createElement("nav",{className:"navbar"},r.a.createElement("div",{className:"user-display justify-center align-items-center"},r.a.createElement("h2",{className:"no-padding"},r.a.createElement("strong",null,t.username)),r.a.createElement("div",{onClick:this.clickUserIcon,className:"ml"},r.a.createElement("div",{className:"user-avatar-container"},r.a.createElement($,{user:t})),i&&r.a.createElement("div",{className:"no-height relative logout-button"},r.a.createElement("div",{onClick:this.logout,className:"button"},"Sign Out")))),r.a.createElement("div",{className:"room-display flex justify-center align-items-center"},u?u.displayRoomName:n)),r.a.createElement("div",{className:"flex max-height-no-nav"},r.a.createElement("div",{className:"rooms-nav flex align-items-center"},r.a.createElement("h2",{className:"chat-title"},"Chat Rooms"),r.a.createElement("hr",{className:"line-break"}),r.a.createElement("div",{className:"width-80 height-80 rooms"},s.map((function(e){return r.a.createElement(ce,{key:e.roomName,isCurrentRoom:e.roomName===n,displayNotification:o.some((function(t){return t===e.roomName})),changeRoom:c,room:e})})))),r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"message-box"},!!u&&r.a.createElement(te,{user:t,messages:u.messages})),r.a.createElement("div",{className:"chat-form"},r.a.createElement(Q,{onSubmit:a,roomName:n})))))}}]),a}(n.Component)),oe=Object(f.g)(P(ae(se))),ie=a(64);function ue(e){var t=e.isSignedIn,a=e.children,n=Object(ie.a)(e,["isSignedIn","children"]);return r.a.createElement(f.b,n,t?a:r.a.createElement(f.a,{to:"/"}))}ue.defaultProps={isSignedIn:!1};var le=ue,me=a(25);var pe=function(e){var t,a=e.kind,n=e.spin,c=void 0!==n&&n,s=e.pulse,o=void 0!==s&&s,i=e.size,u=void 0!==i&&i,l=e.color,m=void 0===l?"black":l;return r.a.createElement("i",{style:{color:m},className:Z()("fa fa-".concat(a),(t={"fa-spin":c},Object(me.a)(t,"fa-".concat(u),u),Object(me.a)(t,"fa-pulse",o),t))})};var fe=function(){return r.a.createElement("div",{className:"loading"},r.a.createElement(pe,{kind:"spinner",size:"5x",pulse:!0}))},de=(a(108),P(function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){(0,this.props.getCurrentUser)()}},{key:"render",value:function(){var e=this.props,t=e.user;return e.isLoading?r.a.createElement(fe,null):r.a.createElement(f.d,null,r.a.createElement(f.b,{exact:!0,path:"/"},r.a.createElement(K,null)),r.a.createElement(f.b,{exact:!0,path:"/sign-in"},r.a.createElement(X,null)),r.a.createElement(f.b,{exact:!0,path:"/sign-up"},r.a.createElement(z,null)),r.a.createElement(le,{isSignedIn:!!t&&!!t.id,path:"/chat"},r.a.createElement(oe,{user:t})),r.a.createElement(f.b,{path:"*"},r.a.createElement(d,null)))}}]),a}(n.Component))),ve=a(62),he=a(16),Ee=a(61),ge={socket:{}},be={user:null,errors:null,isLoading:!0},ye={rooms:[],currentRoom:null,notifications:[]},Oe=Object(he.c)({socket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_SOCKET":return Object(V.a)(Object(V.a)({},e),{},{socket:t.payload});case"SIGN_OUT":return ge;default:return e}},session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_IN":return Object(V.a)(Object(V.a)({},e),{},{user:t.payload,errors:null,isLoading:!1});case"SIGN_OUT":return Object(V.a)(Object(V.a)({},be),{},{isLoading:!1});case"SIGN_IN_FAILURE":return Object(V.a)(Object(V.a)({},e),{},{user:null,errors:t.payload,isLoading:!1});case"LOAD":return Object(V.a)(Object(V.a)({},e),{},{isLoading:!0});default:return e}},rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ROOM":var a=!!e.rooms.find((function(e){return t.payload.roomName===e.roomName}));return a?e:Object(V.a)(Object(V.a)({},e),{},{rooms:e.rooms.concat([t.payload])});case"REMOVE_ROOM":var n=e.rooms.map((function(e){return e.roomName!==t.payload.roomName?e:null}));return Object(V.a)(Object(V.a)({},e),{},{rooms:n});case"CHANGE_ROOM":return Object(V.a)(Object(V.a)({},e),{},{currentRoom:t.payload});case"ADD_MESSAGE":var r=e.rooms.map((function(e){return e.roomName===t.payload.roomName&&(e.messages=[t.payload].concat(e.messages)),e}));return Object(V.a)(Object(V.a)({},e),{},{rooms:r});case"ADD_NOTIFICATION":return e.notifications.includes(t.payload)||e.currentRoom===t.payload?e:Object(V.a)(Object(V.a)({},e),{},{notifications:e.notifications.concat([t.payload])});case"REMOVE_NOTIFICATION":var c=e.notifications.map((function(e){return e!==t.payload?e:null}));return Object(V.a)(Object(V.a)({},e),{},{notifications:c});case"SIGN_OUT":return ye;default:return e}}}),Ne=[Ee.a],je=[he.a.apply(void 0,Ne),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()].filter((function(e){return e})),we=Object(he.e)(Oe,{},he.d.apply(void 0,Object(ve.a)(je)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(109);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:we},r.a.createElement(i.a,null,r.a.createElement(de,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},57:function(e,t,a){},60:function(e,t,a){e.exports=a.p+"static/media/notification.8722f396.svg"},65:function(e,t,a){e.exports=a(110)}},[[65,1,2]]]);
//# sourceMappingURL=main.e2ede7c6.chunk.js.map